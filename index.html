<script>
    const output = document.getElementById('output');
    const input = document.getElementById('user-input');
    const terminal = document.getElementById('terminal');
    const loginModal = document.getElementById('sys-login');
    const attemptDisplay = document.getElementById('attempt-count');
    const deathScreen = document.getElementById('death-screen');
    const sysUser = document.getElementById('sys-user');
    const sysPass = document.getElementById('sys-pass');
    const msg = document.getElementById('login-msg');

    let attempts = 3;

    // --- LÓGICA DE LA TERMINAL ---
    input.addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
            const cmd = input.value.trim().toLowerCase();
            if (cmd === 'exit') {
                terminal.classList.add('hidden');
                loginModal.classList.remove('hidden');
                sysUser.value = '';
                sysPass.value = '';
                setTimeout(() => sysUser.focus(), 100);
            } else if (cmd) {
                const line = document.createElement('div');
                line.innerHTML = `<span style="color:#0a0">[LOG]</span> ~$ ${cmd}<br>Executing... [FAILED_LOAD]`;
                output.appendChild(line);
            }
            input.value = '';
            terminal.scrollTop = terminal.scrollHeight;
        }
    });

    // --- LÓGICA DE LOGIN DINÁMICA ---
    const processLogin = () => {
        const u = sysUser.value.trim();
        const p = sysPass.value.trim();

        if (u === 'admin' && p === 'admin') {
            msg.innerHTML = '<span style="color:#0f0">ACCESS GRANTED. REBOOTING...</span>';
            setTimeout(() => location.reload(), 1000);
        } else {
            attempts--;
            attemptDisplay.innerText = attempts;
            
            if (attempts <= 0) {
                // CIERRE PERMANENTE
                loginModal.classList.add('hidden');
                deathScreen.classList.remove('hidden');
                // Efecto visual de "muerte" del monitor
                document.body.style.animation = "none";
                setTimeout(() => { document.body.style.backgroundColor = "#000"; }, 500);
            } else {
                msg.innerHTML = '<span class="error">INVALID CREDENTIALS. SYSTEM LOCKING...</span>';
                sysUser.value = ''; 
                sysPass.value = '';
                sysUser.focus();
            }
        }
    };

    // Navegación entre inputs del login
    sysUser.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') sysPass.focus();
    });

    sysPass.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') processLogin();
    });
</script>
